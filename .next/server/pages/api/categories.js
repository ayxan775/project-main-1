"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/categories";
exports.ids = ["pages/api/categories"];
exports.modules = {

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "sqlite3":
/*!**************************!*\
  !*** external "sqlite3" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("sqlite3");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "sqlite":
/*!*************************!*\
  !*** external "sqlite" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("sqlite");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcategories&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcategories.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcategories&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcategories.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_categories_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/categories.ts */ \"(api)/./pages/api/categories.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_categories_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_categories_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/categories\",\n        pathname: \"/api/categories\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_categories_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhdGVnb3JpZXMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRmNhdGVnb3JpZXMudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDc0Q7QUFDdEQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHFEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxxREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlLXJlYWN0LXR5cGVzY3JpcHQtc3RhcnRlci8/OWNhYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2NhdGVnb3JpZXMudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYXRlZ29yaWVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2F0ZWdvcmllc1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcategories&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcategories.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/categories.ts":
/*!*********************************!*\
  !*** ./pages/api/categories.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _src_lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _src_lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../src/lib/auth */ \"(api)/./src/lib/auth.ts\");\n\n\nasync function handler(req, res) {\n    try {\n        // Set proper JSON content type\n        res.setHeader(\"Content-Type\", \"application/json\");\n        // Handle GET method (list all categories)\n        if (req.method === \"GET\") {\n            const db = await (0,_src_lib_db__WEBPACK_IMPORTED_MODULE_0__.getDB)();\n            const categories = await db.all(\"SELECT * FROM categories ORDER BY name ASC\");\n            return res.status(200).json(categories);\n        }\n        // For all other methods, verify authentication\n        const token = req.headers.authorization?.split(\" \")[1];\n        if (!token) {\n            return res.status(401).json({\n                message: \"Authentication required\"\n            });\n        }\n        try {\n            await (0,_src_lib_auth__WEBPACK_IMPORTED_MODULE_1__.verifyToken)(token);\n        } catch (error) {\n            return res.status(401).json({\n                message: \"Invalid token\"\n            });\n        }\n        // Handle POST method (create)\n        if (req.method === \"POST\") {\n            const { name, description } = req.body;\n            if (!name) {\n                return res.status(400).json({\n                    message: \"Category name is required\"\n                });\n            }\n            const db = await (0,_src_lib_db__WEBPACK_IMPORTED_MODULE_0__.getDB)();\n            // Check if category already exists\n            const existing = await db.get(\"SELECT * FROM categories WHERE name = ?\", [\n                name\n            ]);\n            if (existing) {\n                return res.status(400).json({\n                    message: \"Category already exists\"\n                });\n            }\n            const result = await db.run(\"INSERT INTO categories (name, description) VALUES (?, ?)\", [\n                name,\n                description || \"\"\n            ]);\n            const newCategory = await db.get(\"SELECT * FROM categories WHERE id = ?\", [\n                result.lastID\n            ]);\n            return res.status(201).json(newCategory);\n        }\n        // Handle PUT method (update)\n        if (req.method === \"PUT\" && req.query.id) {\n            const { name, description } = req.body;\n            if (!name) {\n                return res.status(400).json({\n                    message: \"Category name is required\"\n                });\n            }\n            const db = await (0,_src_lib_db__WEBPACK_IMPORTED_MODULE_0__.getDB)();\n            // Check if category exists\n            const existing = await db.get(\"SELECT * FROM categories WHERE id = ?\", [\n                req.query.id\n            ]);\n            if (!existing) {\n                return res.status(404).json({\n                    message: \"Category not found\"\n                });\n            }\n            // Check if new name conflicts with another category\n            const nameConflict = await db.get(\"SELECT * FROM categories WHERE name = ? AND id != ?\", [\n                name,\n                req.query.id\n            ]);\n            if (nameConflict) {\n                return res.status(400).json({\n                    message: \"Category name already exists\"\n                });\n            }\n            await db.run(\"UPDATE categories SET name = ?, description = ? WHERE id = ?\", [\n                name,\n                description || \"\",\n                req.query.id\n            ]);\n            const updatedCategory = await db.get(\"SELECT * FROM categories WHERE id = ?\", [\n                req.query.id\n            ]);\n            return res.status(200).json(updatedCategory);\n        }\n        // Handle DELETE method\n        if (req.method === \"DELETE\" && req.query.id) {\n            const db = await (0,_src_lib_db__WEBPACK_IMPORTED_MODULE_0__.getDB)();\n            // Check if category exists\n            const category = await db.get(\"SELECT * FROM categories WHERE id = ?\", [\n                req.query.id\n            ]);\n            if (!category) {\n                return res.status(404).json({\n                    message: \"Category not found\"\n                });\n            }\n            // Check if category is in use\n            const productsUsingCategory = await db.get(\"SELECT COUNT(*) as count FROM products WHERE category = ?\", [\n                category.name\n            ]);\n            // If the reassign parameter is provided, move products to that category\n            const reassignTo = req.query.reassignTo;\n            if (productsUsingCategory.count > 0) {\n                if (reassignTo) {\n                    // Check if the target category exists\n                    const targetCategory = await db.get(\"SELECT * FROM categories WHERE name = ?\", [\n                        reassignTo\n                    ]);\n                    if (!targetCategory) {\n                        return res.status(400).json({\n                            message: \"Target category for reassignment not found\"\n                        });\n                    }\n                    // Reassign products to the new category\n                    await db.run(\"UPDATE products SET category = ? WHERE category = ?\", [\n                        reassignTo,\n                        category.name\n                    ]);\n                } else {\n                    // If no reassignment category is provided, prevent deletion\n                    return res.status(400).json({\n                        message: \"Cannot delete category that is being used by products\",\n                        productsCount: productsUsingCategory.count,\n                        canReassign: true\n                    });\n                }\n            }\n            await db.run(\"DELETE FROM categories WHERE id = ?\", [\n                req.query.id\n            ]);\n            return res.status(200).json({\n                message: \"Category deleted successfully\",\n                reassigned: reassignTo ? productsUsingCategory.count : 0\n            });\n        }\n        // Handle unsupported methods\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    } catch (error) {\n        console.error(\"Categories API error:\", error);\n        return res.status(500).json({\n            message: \"Internal server error\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUzt3QkFBNkM7b0JBQ3RGO29CQUVBLHdDQUF3QztvQkFDeEMsTUFBTVQsR0FBR2lCLEdBQUcsQ0FDVix1REFDQTt3QkFBQ1M7d0JBQVlGLFNBQVNiLElBQUk7cUJBQUM7Z0JBRS9CLE9BQU87b0JBQ0wsNERBQTREO29CQUM1RCxPQUFPZCxJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO3dCQUMxQkssU0FBUzt3QkFDVG9CLGVBQWVKLHNCQUFzQkUsS0FBSzt3QkFDMUNHLGFBQWE7b0JBQ2Y7Z0JBQ0Y7WUFDRjtZQUVBLE1BQU05QixHQUFHaUIsR0FBRyxDQUFDLHVDQUF1QztnQkFBQ3JCLElBQUl3QixLQUFLLENBQUNDLEVBQUU7YUFBQztZQUNsRSxPQUFPeEIsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDMUJLLFNBQVM7Z0JBQ1RzQixZQUFZTCxhQUFhRCxzQkFBc0JFLEtBQUssR0FBRztZQUN6RDtRQUNGO1FBRUEsNkJBQTZCO1FBQzdCLE9BQU85QixJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVLLFNBQVM7UUFBcUI7SUFDOUQsRUFBRSxPQUFPQyxPQUFPO1FBQ2RzQixRQUFRdEIsS0FBSyxDQUFDLHlCQUF5QkE7UUFDdkMsT0FBT2IsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFSyxTQUFTO1FBQXdCO0lBQ2pFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlLXJlYWN0LXR5cGVzY3JpcHQtc3RhcnRlci8uL3BhZ2VzL2FwaS9jYXRlZ29yaWVzLnRzPzQzYWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgZ2V0REIgfSBmcm9tICcuLi8uLi9zcmMvbGliL2RiJztcbmltcG9ydCB7IHZlcmlmeVRva2VuIH0gZnJvbSAnLi4vLi4vc3JjL2xpYi9hdXRoJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICB0cnkge1xuICAgIC8vIFNldCBwcm9wZXIgSlNPTiBjb250ZW50IHR5cGVcbiAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuXG4gICAgLy8gSGFuZGxlIEdFVCBtZXRob2QgKGxpc3QgYWxsIGNhdGVnb3JpZXMpXG4gICAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERCKCk7XG4gICAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgZGIuYWxsKCdTRUxFQ1QgKiBGUk9NIGNhdGVnb3JpZXMgT1JERVIgQlkgbmFtZSBBU0MnKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihjYXRlZ29yaWVzKTtcbiAgICB9XG5cbiAgICAvLyBGb3IgYWxsIG90aGVyIG1ldGhvZHMsIHZlcmlmeSBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8uc3BsaXQoJyAnKVsxXTtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBtZXNzYWdlOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB2ZXJpZnlUb2tlbih0b2tlbik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6ICdJbnZhbGlkIHRva2VuJyB9KTtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgUE9TVCBtZXRob2QgKGNyZWF0ZSlcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSByZXEuYm9keTtcblxuICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdDYXRlZ29yeSBuYW1lIGlzIHJlcXVpcmVkJyB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREQigpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiBjYXRlZ29yeSBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBkYi5nZXQoJ1NFTEVDVCAqIEZST00gY2F0ZWdvcmllcyBXSEVSRSBuYW1lID0gPycsIFtuYW1lXSk7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ0NhdGVnb3J5IGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucnVuKFxuICAgICAgICAnSU5TRVJUIElOVE8gY2F0ZWdvcmllcyAobmFtZSwgZGVzY3JpcHRpb24pIFZBTFVFUyAoPywgPyknLFxuICAgICAgICBbbmFtZSwgZGVzY3JpcHRpb24gfHwgJyddXG4gICAgICApO1xuXG4gICAgICBjb25zdCBuZXdDYXRlZ29yeSA9IGF3YWl0IGRiLmdldCgnU0VMRUNUICogRlJPTSBjYXRlZ29yaWVzIFdIRVJFIGlkID0gPycsIFtyZXN1bHQubGFzdElEXSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24obmV3Q2F0ZWdvcnkpO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBQVVQgbWV0aG9kICh1cGRhdGUpXG4gICAgaWYgKHJlcS5tZXRob2QgPT09ICdQVVQnICYmIHJlcS5xdWVyeS5pZCkge1xuICAgICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnQ2F0ZWdvcnkgbmFtZSBpcyByZXF1aXJlZCcgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0REIoKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgY2F0ZWdvcnkgZXhpc3RzXG4gICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGRiLmdldCgnU0VMRUNUICogRlJPTSBjYXRlZ29yaWVzIFdIRVJFIGlkID0gPycsIFtyZXEucXVlcnkuaWRdKTtcbiAgICAgIGlmICghZXhpc3RpbmcpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ0NhdGVnb3J5IG5vdCBmb3VuZCcgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIG5ldyBuYW1lIGNvbmZsaWN0cyB3aXRoIGFub3RoZXIgY2F0ZWdvcnlcbiAgICAgIGNvbnN0IG5hbWVDb25mbGljdCA9IGF3YWl0IGRiLmdldChcbiAgICAgICAgJ1NFTEVDVCAqIEZST00gY2F0ZWdvcmllcyBXSEVSRSBuYW1lID0gPyBBTkQgaWQgIT0gPycsIFxuICAgICAgICBbbmFtZSwgcmVxLnF1ZXJ5LmlkXVxuICAgICAgKTtcbiAgICAgIGlmIChuYW1lQ29uZmxpY3QpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ0NhdGVnb3J5IG5hbWUgYWxyZWFkeSBleGlzdHMnIH0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBkYi5ydW4oXG4gICAgICAgICdVUERBVEUgY2F0ZWdvcmllcyBTRVQgbmFtZSA9ID8sIGRlc2NyaXB0aW9uID0gPyBXSEVSRSBpZCA9ID8nLFxuICAgICAgICBbbmFtZSwgZGVzY3JpcHRpb24gfHwgJycsIHJlcS5xdWVyeS5pZF1cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRDYXRlZ29yeSA9IGF3YWl0IGRiLmdldCgnU0VMRUNUICogRlJPTSBjYXRlZ29yaWVzIFdIRVJFIGlkID0gPycsIFtyZXEucXVlcnkuaWRdKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih1cGRhdGVkQ2F0ZWdvcnkpO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBERUxFVEUgbWV0aG9kXG4gICAgaWYgKHJlcS5tZXRob2QgPT09ICdERUxFVEUnICYmIHJlcS5xdWVyeS5pZCkge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREQigpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiBjYXRlZ29yeSBleGlzdHNcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIGNhdGVnb3JpZXMgV0hFUkUgaWQgPSA/JywgW3JlcS5xdWVyeS5pZF0pO1xuICAgICAgaWYgKCFjYXRlZ29yeSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnQ2F0ZWdvcnkgbm90IGZvdW5kJyB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgY2F0ZWdvcnkgaXMgaW4gdXNlXG4gICAgICBjb25zdCBwcm9kdWN0c1VzaW5nQ2F0ZWdvcnkgPSBhd2FpdCBkYi5nZXQoXG4gICAgICAgICdTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBwcm9kdWN0cyBXSEVSRSBjYXRlZ29yeSA9ID8nLFxuICAgICAgICBbY2F0ZWdvcnkubmFtZV1cbiAgICAgICk7XG5cbiAgICAgIC8vIElmIHRoZSByZWFzc2lnbiBwYXJhbWV0ZXIgaXMgcHJvdmlkZWQsIG1vdmUgcHJvZHVjdHMgdG8gdGhhdCBjYXRlZ29yeVxuICAgICAgY29uc3QgcmVhc3NpZ25UbyA9IHJlcS5xdWVyeS5yZWFzc2lnblRvIGFzIHN0cmluZztcbiAgICAgIFxuICAgICAgaWYgKHByb2R1Y3RzVXNpbmdDYXRlZ29yeS5jb3VudCA+IDApIHtcbiAgICAgICAgaWYgKHJlYXNzaWduVG8pIHtcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0IGNhdGVnb3J5IGV4aXN0c1xuICAgICAgICAgIGNvbnN0IHRhcmdldENhdGVnb3J5ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIGNhdGVnb3JpZXMgV0hFUkUgbmFtZSA9ID8nLCBbcmVhc3NpZ25Ub10pO1xuICAgICAgICAgIGlmICghdGFyZ2V0Q2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdUYXJnZXQgY2F0ZWdvcnkgZm9yIHJlYXNzaWdubWVudCBub3QgZm91bmQnIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBSZWFzc2lnbiBwcm9kdWN0cyB0byB0aGUgbmV3IGNhdGVnb3J5XG4gICAgICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAgICAgJ1VQREFURSBwcm9kdWN0cyBTRVQgY2F0ZWdvcnkgPSA/IFdIRVJFIGNhdGVnb3J5ID0gPycsXG4gICAgICAgICAgICBbcmVhc3NpZ25UbywgY2F0ZWdvcnkubmFtZV1cbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIElmIG5vIHJlYXNzaWdubWVudCBjYXRlZ29yeSBpcyBwcm92aWRlZCwgcHJldmVudCBkZWxldGlvblxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBkZWxldGUgY2F0ZWdvcnkgdGhhdCBpcyBiZWluZyB1c2VkIGJ5IHByb2R1Y3RzJyxcbiAgICAgICAgICAgIHByb2R1Y3RzQ291bnQ6IHByb2R1Y3RzVXNpbmdDYXRlZ29yeS5jb3VudCxcbiAgICAgICAgICAgIGNhblJlYXNzaWduOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYXdhaXQgZGIucnVuKCdERUxFVEUgRlJPTSBjYXRlZ29yaWVzIFdIRVJFIGlkID0gPycsIFtyZXEucXVlcnkuaWRdKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxuICAgICAgICBtZXNzYWdlOiAnQ2F0ZWdvcnkgZGVsZXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICByZWFzc2lnbmVkOiByZWFzc2lnblRvID8gcHJvZHVjdHNVc2luZ0NhdGVnb3J5LmNvdW50IDogMFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHVuc3VwcG9ydGVkIG1ldGhvZHNcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDYXRlZ29yaWVzIEFQSSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbImdldERCIiwidmVyaWZ5VG9rZW4iLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic2V0SGVhZGVyIiwibWV0aG9kIiwiZGIiLCJjYXRlZ29yaWVzIiwiYWxsIiwic3RhdHVzIiwianNvbiIsInRva2VuIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJzcGxpdCIsIm1lc3NhZ2UiLCJlcnJvciIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJleGlzdGluZyIsImdldCIsInJlc3VsdCIsInJ1biIsIm5ld0NhdGVnb3J5IiwibGFzdElEIiwicXVlcnkiLCJpZCIsIm5hbWVDb25mbGljdCIsInVwZGF0ZWRDYXRlZ29yeSIsImNhdGVnb3J5IiwicHJvZHVjdHNVc2luZ0NhdGVnb3J5IiwicmVhc3NpZ25UbyIsImNvdW50IiwidGFyZ2V0Q2F0ZWdvcnkiLCJwcm9kdWN0c0NvdW50IiwiY2FuUmVhc3NpZ24iLCJyZWFzc2lnbmVkIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/categories.ts\n");

/***/ }),

/***/ "(api)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\nasync function verifyToken(token) {\n    return new Promise((resolve, reject)=>{\n        jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET, (err, decoded)=>{\n            if (err) {\n                reject(err);\n            } else {\n                resolve(decoded);\n            }\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQStCO0FBRS9CLE1BQU1DLGFBQWFDLFFBQVFDLEdBQUcsQ0FBQ0YsVUFBVSxJQUFJO0FBRXRDLGVBQWVHLFlBQVlDLEtBQWE7SUFDN0MsT0FBTyxJQUFJQyxRQUFRLENBQUNDLFNBQVNDO1FBQzNCUiwwREFBVSxDQUFDSyxPQUFPSixZQUFZLENBQUNTLEtBQUtDO1lBQ2xDLElBQUlELEtBQUs7Z0JBQ1BGLE9BQU9FO1lBQ1QsT0FBTztnQkFDTEgsUUFBUUk7WUFDVjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGUtcmVhY3QtdHlwZXNjcmlwdC1zdGFydGVyLy4vc3JjL2xpYi9hdXRoLnRzPzY2OTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zZWNyZXQta2V5JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGp3dC52ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQsIChlcnIsIGRlY29kZWQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKGRlY29kZWQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0gIl0sIm5hbWVzIjpbImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwidmVyaWZ5VG9rZW4iLCJ0b2tlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwidmVyaWZ5IiwiZXJyIiwiZGVjb2RlZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(api)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeDB: () => (/* binding */ closeDB),\n/* harmony export */   getDB: () => (/* binding */ getDB),\n/* harmony export */   initializeDB: () => (/* binding */ initializeDB)\n/* harmony export */ });\n// Check if we're running on the server to avoid errors in the browser\nconst isServer = \"undefined\" === \"undefined\";\n// Check if database file exists\nconst doesDBFileExist = async ()=>{\n    if (!isServer) return false;\n    try {\n        const fs = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n        const path = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n        const dbPath = path.join(process.cwd(), \"data.db\");\n        return fs.existsSync(dbPath);\n    } catch (error) {\n        console.error(\"Error checking if DB file exists:\", error);\n        return false;\n    }\n};\n// Track if this is the first time initializing\nlet isFirstInitialization = true;\n// Initialize database\nasync function initializeDB() {\n    if (!isServer) {\n        throw new Error(\"Database operations can only be performed on the server\");\n    }\n    try {\n        // Check if this is the first time running or if the file exists\n        const dbFileExisted = await doesDBFileExist();\n        // Dynamic imports to avoid issues with client-side code\n        const { open } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! sqlite */ \"sqlite\"));\n        const sqlite3 = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! sqlite3 */ \"sqlite3\", 23));\n        const bcrypt = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! bcryptjs */ \"bcryptjs\", 23));\n        const path = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n        const url = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! url */ \"url\", 23));\n        const fs = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n        // Setup paths\n        const __filename = url.fileURLToPath(\"file:///home/home/project-main-1/src/lib/db.ts\");\n        const __dirname = path.dirname(__filename);\n        const DB_PATH = path.join(process.cwd(), \"data.db\");\n        console.log(\"Initializing database at:\", DB_PATH);\n        const db = await open({\n            filename: DB_PATH,\n            driver: sqlite3.default.Database\n        });\n        console.log(\"Connected to database\");\n        // Create tables if they don't exist\n        await db.exec(`\n      CREATE TABLE IF NOT EXISTS users (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        username TEXT UNIQUE NOT NULL,\n        password TEXT NOT NULL,\n        created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n      );\n\n      CREATE TABLE IF NOT EXISTS categories (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT UNIQUE NOT NULL,\n        description TEXT,\n        created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n      );\n\n      CREATE TABLE IF NOT EXISTS products (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT NOT NULL,\n        description TEXT,\n        image TEXT,\n        specs TEXT,\n        useCases TEXT,\n        category TEXT,\n        images TEXT,\n        document TEXT,\n        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (category) REFERENCES categories(name)\n      );\n      \n      CREATE TABLE IF NOT EXISTS job_openings (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        title TEXT NOT NULL,\n        department TEXT NOT NULL,\n        location TEXT NOT NULL,\n        type TEXT NOT NULL,\n        description TEXT NOT NULL,\n        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n        active INTEGER DEFAULT 1\n      );\n    `);\n        console.log(\"Database tables created\");\n        // Alter existing products table to add document column if it doesn't exist\n        try {\n            // Check if the document column exists\n            const tableInfo = await db.all(\"PRAGMA table_info(products)\");\n            const documentColumnExists = tableInfo.some((column)=>column.name === \"document\");\n            if (!documentColumnExists) {\n                // Add document column to products table\n                await db.exec(\"ALTER TABLE products ADD COLUMN document TEXT\");\n                console.log(\"Added document column to products table\");\n            }\n        } catch (error) {\n            console.error(\"Error altering products table:\", error);\n        }\n        // Check if admin user exists, if not create it\n        const adminUser = await db.get(\"SELECT * FROM users WHERE username = ?\", [\n            \"admin\"\n        ]);\n        if (!adminUser) {\n            const hashedPassword = await bcrypt.hash(\"Azerbaycan123\", 10);\n            await db.run(\"INSERT INTO users (username, password) VALUES (?, ?)\", [\n                \"admin\",\n                hashedPassword\n            ]);\n            console.log(\"Admin user created\");\n        }\n        // Initialize default categories if none exist\n        const categoriesCount = await db.get(\"SELECT COUNT(*) as count FROM categories\");\n        if (categoriesCount.count === 0) {\n            const defaultCategories = [\n                {\n                    name: \"Industrial Equipment\",\n                    description: \"Heavy-duty industrial machinery and equipment\"\n                },\n                {\n                    name: \"Safety Gear\",\n                    description: \"Personal protective equipment and safety solutions\"\n                },\n                {\n                    name: \"Measurement Tools\",\n                    description: \"Precision measurement and testing instruments\"\n                },\n                {\n                    name: \"Fluid Control\",\n                    description: \"Valves, pumps, and fluid management systems\"\n                },\n                {\n                    name: \"Power Systems\",\n                    description: \"Power generation and electrical equipment\"\n                },\n                {\n                    name: \"Construction Equipment\",\n                    description: \"Tools and equipment for construction projects\"\n                }\n            ];\n            for (const category of defaultCategories){\n                await db.run(\"INSERT INTO categories (name, description) VALUES (?, ?)\", [\n                    category.name,\n                    category.description\n                ]);\n            }\n        }\n        // Only import initial products if this is a brand new database (file didn't exist before)\n        // and the products table is empty\n        const productsCount = await db.get(\"SELECT COUNT(*) as count FROM products\");\n        if (productsCount.count === 0 && !dbFileExisted && isFirstInitialization) {\n            try {\n                // Try to load products from JSON file\n                const fs = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n                const path = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n                const productsJsonPath = path.join(process.cwd(), \"src\", \"data\", \"products.json\");\n                let products = [];\n                if (fs.existsSync(productsJsonPath)) {\n                    // Read JSON file\n                    const productsJson = fs.readFileSync(productsJsonPath, \"utf8\");\n                    products = JSON.parse(productsJson);\n                    console.log(\"Loaded products from JSON file\");\n                } else {\n                    // Fallback to default product\n                    products = [\n                        {\n                            id: 1,\n                            name: \"Sample Product\",\n                            description: \"A sample product created automatically\",\n                            image: \"https://placehold.co/600x400?text=Sample+Product\",\n                            specs: [\n                                \"Sample specification 1\",\n                                \"Sample specification 2\"\n                            ],\n                            useCases: [\n                                \"Sample use case 1\",\n                                \"Sample use case 2\"\n                            ],\n                            category: \"Sample Category\"\n                        }\n                    ];\n                    console.log(\"Using default product as fallback\");\n                }\n                // Insert products\n                for (const product of products){\n                    await db.run(\"INSERT INTO products (id, name, description, image, specs, useCases, category) VALUES (?, ?, ?, ?, ?, ?, ?)\", [\n                        product.id,\n                        product.name,\n                        product.description,\n                        product.image,\n                        JSON.stringify(product.specs),\n                        JSON.stringify(product.useCases),\n                        product.category\n                    ]);\n                }\n                console.log(`${products.length} products inserted into database`);\n            } catch (error) {\n                console.error(\"Error importing initial products:\", error);\n            }\n        }\n        // Mark that we've already initialized once\n        isFirstInitialization = false;\n        // Initialize default job openings if none exist\n        const jobOpeningsCount = await db.get(\"SELECT COUNT(*) as count FROM job_openings\");\n        if (jobOpeningsCount.count === 0) {\n            const defaultJobs = [\n                {\n                    title: \"Supply Chain Manager\",\n                    department: \"operations\",\n                    location: \"Baku, Azerbaijan\",\n                    type: \"Full-time\",\n                    description: \"Leading and optimizing supply chain operations...\"\n                },\n                {\n                    title: \"Sales Representative\",\n                    department: \"sales\",\n                    location: \"Baku, Azerbaijan\",\n                    type: \"Full-time\",\n                    description: \"Developing and maintaining client relationships...\"\n                },\n                {\n                    title: \"Logistics Coordinator\",\n                    department: \"logistics\",\n                    location: \"Baku, Azerbaijan\",\n                    type: \"Full-time\",\n                    description: \"Coordinating shipment schedules and delivery routes...\"\n                }\n            ];\n            for (const job of defaultJobs){\n                await db.run(\"INSERT INTO job_openings (title, department, location, type, description) VALUES (?, ?, ?, ?, ?)\", [\n                    job.title,\n                    job.department,\n                    job.location,\n                    job.type,\n                    job.description\n                ]);\n            }\n            console.log(\"Default job openings created\");\n        }\n        // Store the db instance in module state\n        dbInstance = db;\n        return db;\n    } catch (error) {\n        console.error(\"Database initialization error:\", error);\n        throw error;\n    }\n}\n// Get database instance\nlet dbInstance = null;\nasync function getDB() {\n    if (!isServer) {\n        throw new Error(\"Database operations can only be performed on the server\");\n    }\n    if (!dbInstance) {\n        dbInstance = await initializeDB();\n    }\n    return dbInstance;\n}\n// Close database connection\nasync function closeDB() {\n    if (!isServer) {\n        throw new Error(\"Database operations can only be performed on the server\");\n    }\n    if (dbInstance) {\n        await dbInstance.close();\n        dbInstance = null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlILFVBQVU7b0JBQUVHLElBQUlGLFFBQVE7b0JBQUVFLElBQUlELElBQUk7b0JBQUVDLElBQUl0QixXQUFXO2lCQUFDO1lBRXhFO1lBQ0FuQyxRQUFRYyxHQUFHLENBQUM7UUFDZDtRQUVBLHdDQUF3QztRQUN4QzRDLGFBQWEzQztRQUNiLE9BQU9BO0lBQ1QsRUFBRSxPQUFPaEIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSx3QkFBd0I7QUFDeEIsSUFBSTJELGFBQXlCO0FBRXRCLGVBQWVDO0lBQ3BCLElBQUksQ0FBQ3JFLFVBQVU7UUFDYixNQUFNLElBQUlhLE1BQU07SUFDbEI7SUFFQSxJQUFJLENBQUN1RCxZQUFZO1FBQ2ZBLGFBQWEsTUFBTXhEO0lBQ3JCO0lBQ0EsT0FBT3dEO0FBQ1Q7QUFFQSw0QkFBNEI7QUFDckIsZUFBZUU7SUFDcEIsSUFBSSxDQUFDdEUsVUFBVTtRQUNiLE1BQU0sSUFBSWEsTUFBTTtJQUNsQjtJQUVBLElBQUl1RCxZQUFZO1FBQ2QsTUFBTUEsV0FBV0csS0FBSztRQUN0QkgsYUFBYTtJQUNmO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlLXJlYWN0LXR5cGVzY3JpcHQtc3RhcnRlci8uL3NyYy9saWIvZGIudHM/OWU0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDaGVjayBpZiB3ZSdyZSBydW5uaW5nIG9uIHRoZSBzZXJ2ZXIgdG8gYXZvaWQgZXJyb3JzIGluIHRoZSBicm93c2VyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnO1xuXG4vLyBUeXBlIGZvciBkYXRhYmFzZSBpbnN0YW5jZVxudHlwZSBEQkluc3RhbmNlID0gYW55O1xuXG4vLyBDaGVjayBpZiBkYXRhYmFzZSBmaWxlIGV4aXN0c1xuY29uc3QgZG9lc0RCRmlsZUV4aXN0ID0gYXN5bmMgKCkgPT4ge1xuICBpZiAoIWlzU2VydmVyKSByZXR1cm4gZmFsc2U7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0KCdmcycpO1xuICAgIGNvbnN0IHBhdGggPSBhd2FpdCBpbXBvcnQoJ3BhdGgnKTtcbiAgICBjb25zdCBkYlBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2RhdGEuZGInKTtcbiAgICByZXR1cm4gZnMuZXhpc3RzU3luYyhkYlBhdGgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGlmIERCIGZpbGUgZXhpc3RzOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbi8vIFRyYWNrIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgaW5pdGlhbGl6aW5nXG5sZXQgaXNGaXJzdEluaXRpYWxpemF0aW9uID0gdHJ1ZTtcblxuLy8gSW5pdGlhbGl6ZSBkYXRhYmFzZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVEQigpIHtcbiAgaWYgKCFpc1NlcnZlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2Ugb3BlcmF0aW9ucyBjYW4gb25seSBiZSBwZXJmb3JtZWQgb24gdGhlIHNlcnZlcicpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBpZiB0aGlzIGlzIHRoZSBmaXJzdCB0aW1lIHJ1bm5pbmcgb3IgaWYgdGhlIGZpbGUgZXhpc3RzXG4gICAgY29uc3QgZGJGaWxlRXhpc3RlZCA9IGF3YWl0IGRvZXNEQkZpbGVFeGlzdCgpO1xuICAgIFxuICAgIC8vIER5bmFtaWMgaW1wb3J0cyB0byBhdm9pZCBpc3N1ZXMgd2l0aCBjbGllbnQtc2lkZSBjb2RlXG4gICAgY29uc3QgeyBvcGVuIH0gPSBhd2FpdCBpbXBvcnQoJ3NxbGl0ZScpO1xuICAgIGNvbnN0IHNxbGl0ZTMgPSBhd2FpdCBpbXBvcnQoJ3NxbGl0ZTMnKTtcbiAgICBjb25zdCBiY3J5cHQgPSBhd2FpdCBpbXBvcnQoJ2JjcnlwdGpzJyk7XG4gICAgY29uc3QgcGF0aCA9IGF3YWl0IGltcG9ydCgncGF0aCcpO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IGltcG9ydCgndXJsJyk7XG4gICAgY29uc3QgZnMgPSBhd2FpdCBpbXBvcnQoJ2ZzJyk7XG5cbiAgICAvLyBTZXR1cCBwYXRoc1xuICAgIGNvbnN0IF9fZmlsZW5hbWUgPSB1cmwuZmlsZVVSTFRvUGF0aChpbXBvcnQubWV0YS51cmwpO1xuICAgIGNvbnN0IF9fZGlybmFtZSA9IHBhdGguZGlybmFtZShfX2ZpbGVuYW1lKTtcbiAgICBjb25zdCBEQl9QQVRIID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdkYXRhLmRiJyk7XG5cbiAgICBjb25zb2xlLmxvZygnSW5pdGlhbGl6aW5nIGRhdGFiYXNlIGF0OicsIERCX1BBVEgpO1xuICAgIFxuICAgIGNvbnN0IGRiID0gYXdhaXQgb3Blbih7XG4gICAgICBmaWxlbmFtZTogREJfUEFUSCxcbiAgICAgIGRyaXZlcjogc3FsaXRlMy5kZWZhdWx0LkRhdGFiYXNlXG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0Nvbm5lY3RlZCB0byBkYXRhYmFzZScpO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0YWJsZXMgaWYgdGhleSBkb24ndCBleGlzdFxuICAgIGF3YWl0IGRiLmV4ZWMoYFxuICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcnMgKFxuICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgIHVzZXJuYW1lIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxuICAgICAgICBwYXNzd29yZCBURVhUIE5PVCBOVUxMLFxuICAgICAgICBjcmVhdGVkX2F0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVBcbiAgICAgICk7XG5cbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNhdGVnb3JpZXMgKFxuICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgIG5hbWUgVEVYVCBVTklRVUUgTk9UIE5VTEwsXG4gICAgICAgIGRlc2NyaXB0aW9uIFRFWFQsXG4gICAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgKTtcblxuICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgcHJvZHVjdHMgKFxuICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgIG5hbWUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgZGVzY3JpcHRpb24gVEVYVCxcbiAgICAgICAgaW1hZ2UgVEVYVCxcbiAgICAgICAgc3BlY3MgVEVYVCxcbiAgICAgICAgdXNlQ2FzZXMgVEVYVCxcbiAgICAgICAgY2F0ZWdvcnkgVEVYVCxcbiAgICAgICAgaW1hZ2VzIFRFWFQsXG4gICAgICAgIGRvY3VtZW50IFRFWFQsXG4gICAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgRk9SRUlHTiBLRVkgKGNhdGVnb3J5KSBSRUZFUkVOQ0VTIGNhdGVnb3JpZXMobmFtZSlcbiAgICAgICk7XG4gICAgICBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGpvYl9vcGVuaW5ncyAoXG4gICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgICAgdGl0bGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgZGVwYXJ0bWVudCBURVhUIE5PVCBOVUxMLFxuICAgICAgICBsb2NhdGlvbiBURVhUIE5PVCBOVUxMLFxuICAgICAgICB0eXBlIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgIGRlc2NyaXB0aW9uIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgYWN0aXZlIElOVEVHRVIgREVGQVVMVCAxXG4gICAgICApO1xuICAgIGApO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSB0YWJsZXMgY3JlYXRlZCcpO1xuXG4gICAgLy8gQWx0ZXIgZXhpc3RpbmcgcHJvZHVjdHMgdGFibGUgdG8gYWRkIGRvY3VtZW50IGNvbHVtbiBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBkb2N1bWVudCBjb2x1bW4gZXhpc3RzXG4gICAgICBjb25zdCB0YWJsZUluZm8gPSBhd2FpdCBkYi5hbGwoJ1BSQUdNQSB0YWJsZV9pbmZvKHByb2R1Y3RzKScpO1xuICAgICAgY29uc3QgZG9jdW1lbnRDb2x1bW5FeGlzdHMgPSB0YWJsZUluZm8uc29tZSgoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5uYW1lID09PSAnZG9jdW1lbnQnKTtcbiAgICAgIFxuICAgICAgaWYgKCFkb2N1bWVudENvbHVtbkV4aXN0cykge1xuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgY29sdW1uIHRvIHByb2R1Y3RzIHRhYmxlXG4gICAgICAgIGF3YWl0IGRiLmV4ZWMoJ0FMVEVSIFRBQkxFIHByb2R1Y3RzIEFERCBDT0xVTU4gZG9jdW1lbnQgVEVYVCcpO1xuICAgICAgICBjb25zb2xlLmxvZygnQWRkZWQgZG9jdW1lbnQgY29sdW1uIHRvIHByb2R1Y3RzIHRhYmxlJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFsdGVyaW5nIHByb2R1Y3RzIHRhYmxlOicsIGVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBhZG1pbiB1c2VyIGV4aXN0cywgaWYgbm90IGNyZWF0ZSBpdFxuICAgIGNvbnN0IGFkbWluVXNlciA9IGF3YWl0IGRiLmdldCgnU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ID8nLCBbJ2FkbWluJ10pO1xuICAgIFxuICAgIGlmICghYWRtaW5Vc2VyKSB7XG4gICAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKCdBemVyYmF5Y2FuMTIzJywgMTApO1xuICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAnSU5TRVJUIElOVE8gdXNlcnMgKHVzZXJuYW1lLCBwYXNzd29yZCkgVkFMVUVTICg/LCA/KScsXG4gICAgICAgIFsnYWRtaW4nLCBoYXNoZWRQYXNzd29yZF1cbiAgICAgICk7XG4gICAgICBjb25zb2xlLmxvZygnQWRtaW4gdXNlciBjcmVhdGVkJyk7XG4gICAgfVxuXG4gICAgLy8gSW5pdGlhbGl6ZSBkZWZhdWx0IGNhdGVnb3JpZXMgaWYgbm9uZSBleGlzdFxuICAgIGNvbnN0IGNhdGVnb3JpZXNDb3VudCA9IGF3YWl0IGRiLmdldCgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gY2F0ZWdvcmllcycpO1xuICAgIGlmIChjYXRlZ29yaWVzQ291bnQuY291bnQgPT09IDApIHtcbiAgICAgIGNvbnN0IGRlZmF1bHRDYXRlZ29yaWVzID0gW1xuICAgICAgICB7IG5hbWU6ICdJbmR1c3RyaWFsIEVxdWlwbWVudCcsIGRlc2NyaXB0aW9uOiAnSGVhdnktZHV0eSBpbmR1c3RyaWFsIG1hY2hpbmVyeSBhbmQgZXF1aXBtZW50JyB9LFxuICAgICAgICB7IG5hbWU6ICdTYWZldHkgR2VhcicsIGRlc2NyaXB0aW9uOiAnUGVyc29uYWwgcHJvdGVjdGl2ZSBlcXVpcG1lbnQgYW5kIHNhZmV0eSBzb2x1dGlvbnMnIH0sXG4gICAgICAgIHsgbmFtZTogJ01lYXN1cmVtZW50IFRvb2xzJywgZGVzY3JpcHRpb246ICdQcmVjaXNpb24gbWVhc3VyZW1lbnQgYW5kIHRlc3RpbmcgaW5zdHJ1bWVudHMnIH0sXG4gICAgICAgIHsgbmFtZTogJ0ZsdWlkIENvbnRyb2wnLCBkZXNjcmlwdGlvbjogJ1ZhbHZlcywgcHVtcHMsIGFuZCBmbHVpZCBtYW5hZ2VtZW50IHN5c3RlbXMnIH0sXG4gICAgICAgIHsgbmFtZTogJ1Bvd2VyIFN5c3RlbXMnLCBkZXNjcmlwdGlvbjogJ1Bvd2VyIGdlbmVyYXRpb24gYW5kIGVsZWN0cmljYWwgZXF1aXBtZW50JyB9LFxuICAgICAgICB7IG5hbWU6ICdDb25zdHJ1Y3Rpb24gRXF1aXBtZW50JywgZGVzY3JpcHRpb246ICdUb29scyBhbmQgZXF1aXBtZW50IGZvciBjb25zdHJ1Y3Rpb24gcHJvamVjdHMnIH1cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgY2F0ZWdvcnkgb2YgZGVmYXVsdENhdGVnb3JpZXMpIHtcbiAgICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAgICdJTlNFUlQgSU5UTyBjYXRlZ29yaWVzIChuYW1lLCBkZXNjcmlwdGlvbikgVkFMVUVTICg/LCA/KScsXG4gICAgICAgICAgW2NhdGVnb3J5Lm5hbWUsIGNhdGVnb3J5LmRlc2NyaXB0aW9uXVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE9ubHkgaW1wb3J0IGluaXRpYWwgcHJvZHVjdHMgaWYgdGhpcyBpcyBhIGJyYW5kIG5ldyBkYXRhYmFzZSAoZmlsZSBkaWRuJ3QgZXhpc3QgYmVmb3JlKVxuICAgIC8vIGFuZCB0aGUgcHJvZHVjdHMgdGFibGUgaXMgZW1wdHlcbiAgICBjb25zdCBwcm9kdWN0c0NvdW50ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBwcm9kdWN0cycpO1xuICAgIFxuICAgIGlmIChwcm9kdWN0c0NvdW50LmNvdW50ID09PSAwICYmICFkYkZpbGVFeGlzdGVkICYmIGlzRmlyc3RJbml0aWFsaXphdGlvbikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVHJ5IHRvIGxvYWQgcHJvZHVjdHMgZnJvbSBKU09OIGZpbGVcbiAgICAgICAgY29uc3QgZnMgPSBhd2FpdCBpbXBvcnQoJ2ZzJyk7XG4gICAgICAgIGNvbnN0IHBhdGggPSBhd2FpdCBpbXBvcnQoJ3BhdGgnKTtcbiAgICAgICAgY29uc3QgcHJvZHVjdHNKc29uUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnc3JjJywgJ2RhdGEnLCAncHJvZHVjdHMuanNvbicpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHByb2R1Y3RzID0gW107XG4gICAgICAgIFxuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhwcm9kdWN0c0pzb25QYXRoKSkge1xuICAgICAgICAgIC8vIFJlYWQgSlNPTiBmaWxlXG4gICAgICAgICAgY29uc3QgcHJvZHVjdHNKc29uID0gZnMucmVhZEZpbGVTeW5jKHByb2R1Y3RzSnNvblBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgcHJvZHVjdHMgPSBKU09OLnBhcnNlKHByb2R1Y3RzSnNvbik7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0xvYWRlZCBwcm9kdWN0cyBmcm9tIEpTT04gZmlsZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIGRlZmF1bHQgcHJvZHVjdFxuICAgICAgICAgIHByb2R1Y3RzID0gW3tcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgbmFtZTogXCJTYW1wbGUgUHJvZHVjdFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQSBzYW1wbGUgcHJvZHVjdCBjcmVhdGVkIGF1dG9tYXRpY2FsbHlcIixcbiAgICAgICAgICAgIGltYWdlOiBcImh0dHBzOi8vcGxhY2Vob2xkLmNvLzYwMHg0MDA/dGV4dD1TYW1wbGUrUHJvZHVjdFwiLFxuICAgICAgICAgICAgc3BlY3M6IFtcIlNhbXBsZSBzcGVjaWZpY2F0aW9uIDFcIiwgXCJTYW1wbGUgc3BlY2lmaWNhdGlvbiAyXCJdLFxuICAgICAgICAgICAgdXNlQ2FzZXM6IFtcIlNhbXBsZSB1c2UgY2FzZSAxXCIsIFwiU2FtcGxlIHVzZSBjYXNlIDJcIl0sXG4gICAgICAgICAgICBjYXRlZ29yeTogXCJTYW1wbGUgQ2F0ZWdvcnlcIlxuICAgICAgICAgIH1dO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBkZWZhdWx0IHByb2R1Y3QgYXMgZmFsbGJhY2snKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSW5zZXJ0IHByb2R1Y3RzXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdCBvZiBwcm9kdWN0cykge1xuICAgICAgICAgIGF3YWl0IGRiLnJ1bihcbiAgICAgICAgICAgICdJTlNFUlQgSU5UTyBwcm9kdWN0cyAoaWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBpbWFnZSwgc3BlY3MsIHVzZUNhc2VzLCBjYXRlZ29yeSkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/KScsXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgIHByb2R1Y3QuaWQsXG4gICAgICAgICAgICAgIHByb2R1Y3QubmFtZSxcbiAgICAgICAgICAgICAgcHJvZHVjdC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgcHJvZHVjdC5pbWFnZSxcbiAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocHJvZHVjdC5zcGVjcyksXG4gICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHByb2R1Y3QudXNlQ2FzZXMpLFxuICAgICAgICAgICAgICBwcm9kdWN0LmNhdGVnb3J5XG4gICAgICAgICAgICBdXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhgJHtwcm9kdWN0cy5sZW5ndGh9IHByb2R1Y3RzIGluc2VydGVkIGludG8gZGF0YWJhc2VgKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGltcG9ydGluZyBpbml0aWFsIHByb2R1Y3RzOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gTWFyayB0aGF0IHdlJ3ZlIGFscmVhZHkgaW5pdGlhbGl6ZWQgb25jZVxuICAgIGlzRmlyc3RJbml0aWFsaXphdGlvbiA9IGZhbHNlO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBkZWZhdWx0IGpvYiBvcGVuaW5ncyBpZiBub25lIGV4aXN0XG4gICAgY29uc3Qgam9iT3BlbmluZ3NDb3VudCA9IGF3YWl0IGRiLmdldCgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gam9iX29wZW5pbmdzJyk7XG4gICAgaWYgKGpvYk9wZW5pbmdzQ291bnQuY291bnQgPT09IDApIHtcbiAgICAgIGNvbnN0IGRlZmF1bHRKb2JzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgdGl0bGU6IFwiU3VwcGx5IENoYWluIE1hbmFnZXJcIixcbiAgICAgICAgICBkZXBhcnRtZW50OiBcIm9wZXJhdGlvbnNcIixcbiAgICAgICAgICBsb2NhdGlvbjogXCJCYWt1LCBBemVyYmFpamFuXCIsXG4gICAgICAgICAgdHlwZTogXCJGdWxsLXRpbWVcIixcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJMZWFkaW5nIGFuZCBvcHRpbWl6aW5nIHN1cHBseSBjaGFpbiBvcGVyYXRpb25zLi4uXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRpdGxlOiBcIlNhbGVzIFJlcHJlc2VudGF0aXZlXCIsXG4gICAgICAgICAgZGVwYXJ0bWVudDogXCJzYWxlc1wiLFxuICAgICAgICAgIGxvY2F0aW9uOiBcIkJha3UsIEF6ZXJiYWlqYW5cIixcbiAgICAgICAgICB0eXBlOiBcIkZ1bGwtdGltZVwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkRldmVsb3BpbmcgYW5kIG1haW50YWluaW5nIGNsaWVudCByZWxhdGlvbnNoaXBzLi4uXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRpdGxlOiBcIkxvZ2lzdGljcyBDb29yZGluYXRvclwiLFxuICAgICAgICAgIGRlcGFydG1lbnQ6IFwibG9naXN0aWNzXCIsXG4gICAgICAgICAgbG9jYXRpb246IFwiQmFrdSwgQXplcmJhaWphblwiLFxuICAgICAgICAgIHR5cGU6IFwiRnVsbC10aW1lXCIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQ29vcmRpbmF0aW5nIHNoaXBtZW50IHNjaGVkdWxlcyBhbmQgZGVsaXZlcnkgcm91dGVzLi4uXCJcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBqb2Igb2YgZGVmYXVsdEpvYnMpIHtcbiAgICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAgICdJTlNFUlQgSU5UTyBqb2Jfb3BlbmluZ3MgKHRpdGxlLCBkZXBhcnRtZW50LCBsb2NhdGlvbiwgdHlwZSwgZGVzY3JpcHRpb24pIFZBTFVFUyAoPywgPywgPywgPywgPyknLFxuICAgICAgICAgIFtqb2IudGl0bGUsIGpvYi5kZXBhcnRtZW50LCBqb2IubG9jYXRpb24sIGpvYi50eXBlLCBqb2IuZGVzY3JpcHRpb25dXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZygnRGVmYXVsdCBqb2Igb3BlbmluZ3MgY3JlYXRlZCcpO1xuICAgIH1cblxuICAgIC8vIFN0b3JlIHRoZSBkYiBpbnN0YW5jZSBpbiBtb2R1bGUgc3RhdGVcbiAgICBkYkluc3RhbmNlID0gZGI7XG4gICAgcmV0dXJuIGRiO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGluaXRpYWxpemF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBHZXQgZGF0YWJhc2UgaW5zdGFuY2VcbmxldCBkYkluc3RhbmNlOiBEQkluc3RhbmNlID0gbnVsbDtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldERCKCkge1xuICBpZiAoIWlzU2VydmVyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBvcGVyYXRpb25zIGNhbiBvbmx5IGJlIHBlcmZvcm1lZCBvbiB0aGUgc2VydmVyJyk7XG4gIH1cbiAgXG4gIGlmICghZGJJbnN0YW5jZSkge1xuICAgIGRiSW5zdGFuY2UgPSBhd2FpdCBpbml0aWFsaXplREIoKTtcbiAgfVxuICByZXR1cm4gZGJJbnN0YW5jZTtcbn1cblxuLy8gQ2xvc2UgZGF0YWJhc2UgY29ubmVjdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsb3NlREIoKSB7XG4gIGlmICghaXNTZXJ2ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIG9wZXJhdGlvbnMgY2FuIG9ubHkgYmUgcGVyZm9ybWVkIG9uIHRoZSBzZXJ2ZXInKTtcbiAgfVxuICBcbiAgaWYgKGRiSW5zdGFuY2UpIHtcbiAgICBhd2FpdCBkYkluc3RhbmNlLmNsb3NlKCk7XG4gICAgZGJJbnN0YW5jZSA9IG51bGw7XG4gIH1cbn0gIl0sIm5hbWVzIjpbImlzU2VydmVyIiwiZG9lc0RCRmlsZUV4aXN0IiwiZnMiLCJwYXRoIiwiZGJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJleGlzdHNTeW5jIiwiZXJyb3IiLCJjb25zb2xlIiwiaXNGaXJzdEluaXRpYWxpemF0aW9uIiwiaW5pdGlhbGl6ZURCIiwiRXJyb3IiLCJkYkZpbGVFeGlzdGVkIiwib3BlbiIsInNxbGl0ZTMiLCJiY3J5cHQiLCJ1cmwiLCJfX2ZpbGVuYW1lIiwiZmlsZVVSTFRvUGF0aCIsIl9fZGlybmFtZSIsImRpcm5hbWUiLCJEQl9QQVRIIiwibG9nIiwiZGIiLCJmaWxlbmFtZSIsImRyaXZlciIsImRlZmF1bHQiLCJEYXRhYmFzZSIsImV4ZWMiLCJ0YWJsZUluZm8iLCJhbGwiLCJkb2N1bWVudENvbHVtbkV4aXN0cyIsInNvbWUiLCJjb2x1bW4iLCJuYW1lIiwiYWRtaW5Vc2VyIiwiZ2V0IiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwicnVuIiwiY2F0ZWdvcmllc0NvdW50IiwiY291bnQiLCJkZWZhdWx0Q2F0ZWdvcmllcyIsImRlc2NyaXB0aW9uIiwiY2F0ZWdvcnkiLCJwcm9kdWN0c0NvdW50IiwicHJvZHVjdHNKc29uUGF0aCIsInByb2R1Y3RzIiwicHJvZHVjdHNKc29uIiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwiaWQiLCJpbWFnZSIsInNwZWNzIiwidXNlQ2FzZXMiLCJwcm9kdWN0Iiwic3RyaW5naWZ5IiwibGVuZ3RoIiwiam9iT3BlbmluZ3NDb3VudCIsImRlZmF1bHRKb2JzIiwidGl0bGUiLCJkZXBhcnRtZW50IiwibG9jYXRpb24iLCJ0eXBlIiwiam9iIiwiZGJJbnN0YW5jZSIsImdldERCIiwiY2xvc2VEQiIsImNsb3NlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcategories&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcategories.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();